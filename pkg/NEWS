LEFKO3 NEWS
-----------

CHANGES IN VERSION 4.0.1 (2021-11-15)
-------------------------------------
  BUG FIXES
    1. Function aflefko2() now properly removes agestages rows when 
       reduce = TRUE.
    2. Problems with mathjaxr integration fixed.


CHANGES IN VERSION 4.0.0 (2021-11-14)
-------------------------------------
  NEW FEATURES
    1. Function projection3() can now run density dependent projections using
       the Ricker, Beverton-Holt, Usher, and logistic functions.
    2. Functions start_input() and density_input() have been created to describe
       starting vectors and density dependence in the simplest format possible.
    3. Function modelsearch() now also calculates the accuracy of binomial
       models and adds the output to the QC section of the output. Function
       summary.lefkoMod() reports this output.
    4. Function sf_create() now handles dual- and triple-size classification
    5. Functions sf_create() and supplemental() now handle the designation of
       core stage groups.
    6. Functions verticalize3() and historicalize3() now handle dual- and
       triple-size metric classification.
    7. Function modelsearch() can now test the impacts of three different size
       variables, and can also develop vital rate models for up to three
       separate response size variables.
    8. Function modelsearch() can now test the impacts of spatial density and
       stage group.
    9. Function modelsearch() now allows individual covariates to be
       incorporated as random categorical variables, as well as fixed
       continuous quantitative variables.
    10. Function modelsearch() now also allows the Gamma distribution for size
        and fecundity.
    11. Function flefko2() now handles up to three size metrics, stage groups,
        random categorical variables, and density.
    12. Function sf_distrib() now handles up to three size metrics, and also
        handles fecundity estimation in both times t and t+1.
    13. Function projection3() now allows two forms of enforced
        substochasticity. The first keeps all survival-transition probabilities
        within bounds, while the second keeps all stage survival probabilities
        within bounds.
    
  USER-VISIBLE CHANGES
    1. Function projection3() now creates easier-to-understand output structures
       clearly dividing numbers of individuals from stage distributions from
       reproductive values and population sizes.
    2. Function supplemental() now takes proxy multipliers, and gives errors for
       negative given rates and multipliers.
    3. Corrected some figure dimensions in vignettes.
    4. Corrected help text for some functions.
    5. Functions sf_distrib(), summary.lefkoMat(), summary.lefkoCondMat(),
       summary.lefkoMod(), and image3() no longer return a NULL to the console.
    6. The default for option censorRepeat in function verticalize3() has been
       changed to FALSE, in order to prevent overzealous censoring by default.
    7. Text output from summary functions and sf_distrib() has been altered to
       fit within standard output consoles, including typical page widths.
    8. Added sparse matrix override to slambda3() in case of errors incurred in
       eigen analysis.
    
  BUG FIXES
    1. Corrected bug causing code "npr" to yield propagule stages in time t+1
       in supplement and overwrite tables.
    2. Fixed issue preventing estimation of size transition into observable
       classes with size 0 under the Poisson distribution in flefko3() and
       flefko2().
    3. Corrected porous stage assignment handling in historicalize3().
    4. Eliminated incorrect projection set assignment when running multiple
       patches or populations through function projection3().
    5. Eliminated bug giving warnings when running rlefko2() and rlefko3() with
       specific choices of patches or populations given as input options.
    6. Fixed issue causing rlefko2() and rlefko3() to estimate only some
       transition-survival probabilities and fecundities when patchcol or popcol
       is given without any respective specific patch or pop options given.


CHANGES IN VERSION 3.8.0 (2021-09-08)
-------------------------------------
  NEW FEATURES
    1. Function projection3() now includes the ability to produce replicate
       simulations.
    2. Function summary.lefkoProj() created to summarize the results of
       population projection using function projection3().
    3. Functions verticalize3() and historicalize3() now handle true radial
       density estimation, if X and Y coordinates and a valid spacing threshold
       are supplied.
    4. Functions add_lM() and delete_lM() added to add and delete matrices from
       lefkoMat objects.
    5. Function subset_lM() added to create new lefkoMat objects as subsets of
       other lefkoMat objects.
    
  USER-VISIBLE CHANGES
    1. Sensitivity and elasticity descriptions corrected in vignettes.
    2. Increased consistency in terminology used in output for stablestage3()
       and repvalue3().
    3. Function create_lM() now handles age-by-stage matrices.
    
  BUG FIXES
    1. Fixed issue that could lead rlefko2() and rlefko3() to stop processing
       matrices if specific years or patches are called.
    2. Fixed issue affecting stochastic reproductive value estimation in
       historical lefkoMat objects.
    3. Fixed issue affecting some deterministic reproductive value estimates,
       particularly in large historical MPMs, where a base reference value for
       standardization cannot be determined.
    4. Fixed issue preventing proper handling of historical matrix inputs in
       create_lM().


CHANGES IN VERSION 3.7.0 (2021-08-18)
-------------------------------------
  NEW FEATURES
    1. Function ltre3() developed to conduct deterministic and stochastic life
       table response experiments.
    2. Function create_lM() developed to allow the incorporation of lists of
       matrices developed outside of package lefko3.
    3. Function summary.lefkoLTRE() developed to quickly summarize LTRE
       contributions according to transition type.
    4. Added new vignette to showcase LTRE and sLTRE analysis, and the import of
       matrices as lefkoMat objects.

  USER-VISIBLE CHANGES
    1. Altered some terminology in help files and vignettes to reflect most
       recent best practice in population ecology. Updated vignettes with new
       information, particularly related to LTRE and sLTRE analysis.
    2. Option append_mats has been added to sensitivity3.lefkoMat(),
       sensitivity3.list(), elasticity3.lefkoMat(), and elasticity3.list(). This
       option allows users to prevent the incorporation of the original matrices
       into output lefkoSens and lefkoElas objects, resulting in lower memory
       usage.
    3. Function summary.lefkoElas() can now handle age-by-stage MPMs.
    4. Corrected problematic Cypripedium examples involving the construction of
       matrices with stage survival probabilities rising above 1.0.
    
  BUG FIXES
    1. Fixed indexing bug in function summary.lefkoElas() that had led to
       incorrect elasticity summation.
    2. Fixed memory leak affecting sparse matrices in projection3() and related
       functions.


CHANGES IN VERSION 3.6.0 (2021-07-21)
-------------------------------------
  NEW FEATURES
    1. Automatic sparse matrix detection and override options have been added to
       all population dynamics functions.

  USER-VISIBLE CHANGES
    1. All population dynamics analysis functions have been substantially sped
       up through better memory management techniques.


CHANGES IN VERSION 3.5.3 (2021-07-14)
-------------------------------------
  NEW FEATURES
    1. Function summary.lefkoMat() now also displays column sums from all
       U (survival-transition) matrices as a quality control check.

  USER-VISIBLE CHANGES
    1. Package glmmTMB has been reintegrated, allowing mixed modeling of
       negative binomial, zero-inflated, and zero-truncated response
       distributions again.
    2. Error and warning messages from compiled functions provide cleaner
       messages.

  BUG FIXES
    1. Corrected incorrect handling of missing patch terms in lm, glm, vglm, and
       zeroinfl objects.
    2. Corrected static_cast issue that might prevent package installation in
       Solaris systems.


CHANGES IN VERSION 3.5.2 (2021-07-12)
-------------------------------------
  USER-VISIBLE CHANGES
    1. Negative binomial response, zero-truncated, and zero-inflated
       have been temporarily disabled in function modelsearch() while package
       glmmTMB() is being reprogrammed for compatibility with R 4.1.0. These
       distributions are still available through the glm approach.
    2. Examples have been updated for clarity and consistency.


CHANGES IN VERSION 3.5.1 (2021-07-07)
-------------------------------------
  NEW FEATURES
    1. Function supplemental() now allows entry stage proxies to be marked for
       raw historical MPMs.
    2. Shortcuts included covering non-propagule stages and non-reproductive
       mature stages for functions overwrite() and supplemental().

  USER-VISIBLE CHANGES
    1. Updated Lathyrus vignettes to correct improper handling of entry stages.
    2. Negative binomial response in mixed modeling has been moved to package
       lme4, and zero-truncated and zero-inflated distributions are available
       only through the glm approach in modelsearch() for the time being.

  BUG FIXES
    1. Corrected improper handling of prior forms of entry stages in raw
       historical MPMs.


CHANGES IN VERSION 3.5.0 (2021-06-29)
-------------------------------------
  NEW FEATURES
    1. Historical MPM estimating functions can now estimate hMPMs in deVries
       format, in which newborns have an unique prior stage. All population
       dynamics functions have also been reworked to handle this format.
    2. New output has been added showing the exact order of age-stage
       combinations across all rows in estimated age-by-stage MPMs, as output
       from function aflefko2().
    3. Stochastic sensitivities of historical MPMs now yield ahistorical
       equivalents in all output.
    4. Added manual designation of ahistorical vs. historical output in
       functions sensitivity3.list() and elasticity3.list().

  USER-VISIBLE CHANGES
    1. Function modelsearch() can now handle invariant response terms.
    2. Functions flefko3() and flefko2() can now handle invariant fecundity.
    3. Function verticalize3() can now handle horizontal datasets without clear
       patterns in order.
    4. Amended overwrite() and supplemental() functions to account for possible
       prior newborn stage in deVries formatted hMPMs.
    5. Function supplemental() now details stage names not accounted for in the
       input stageframe in error messages.
    6. Some error and warning messages have been clarified for better
       understanding.
    7. Many examples have been expanded to include extra conditions.

  BUG FIXES
    1. Function rlefko3() now handles dimension reduction properly.
    2. Function cond_hmpm() now produces conditional matrices from all
       combinations of population, subpopulation, and year, and also properly
       labels them.
    3. Typos and other issues corrected in vignettes.


CHANGES IN VERSION 3.4.0 (2021-03-31)
-------------------------------------
  NEW FEATURES
    1. Zero-truncated Poisson and negative binomial distributions have been
       added to function modelsearch(), and as underlying size and fecundity
       distributions in flefko3(), flefko2(), and aflefko2().
    2. New function image3() created to easily create matrix images for lefkoMat
       and other objects. Function acts as a wrapper for the image() function in
       package SparseM.
    3. New vignette showcasing the estimation and analysis of age x stage MPMs.
  
  USER-VISIBLE CHANGES
    1. Added err_check option to function-based matrix estimators, allowing the
       output of vital rates used in the estimation of U matrices.
    2. The test used to assess overdispersion in size and fecundity has been
       changed to deal more accurately with count-based variance (including
       tests performed and how data are subsetted), and to offer more choices in
       which tests to run.
    3. Function modelsearch() has been rewritten to result in a smaller
       installed package size.
    4. Function parasearch() has been removed pending revision of modeling
       methodology.
    5. Reproductive value vectors are now all standardized to the first non-zero
       value in the vector.
    6. Function sf_create() can now handle stage comments as input.
    7. Functions sensitivity3() and elasticity3() have been redesigned for
       increased speed with unusually large matrices.
    8. Stochastic analysis functions have been streamlined for speed and
       efficiency.
    9. Expanded all examples to include both Lathyrus and Cypripedium versions.
    10. Corrections and expansions to package vignettes.
  
  BUG FIXES
    1. Fixed issue in which loss of one of the year or patch terms in modeling
       of zero-inflated mixed models could lead to errors in function-based
       matrix estimation.
    2. Corrected error in estimation algorithm for size transition probability
       under negative binomial distribution, and difficulty in handling low
       levels of overdispersion in some negative binomial models.
    3. Fixed issue making lmean() unable to take element-wise mean matrices of
       age x stage MPMs produced using aflefko2().
    4. Fixed bug yielding erroneous reproductive values in historical matrices.
    5. Fixed bug yielding erroneous sensitivity elements in historically-
       corrected ahistorical sensitivity matrices.
    6. Fixed bug occasionally yielding 3d arrays in response to stochastic
       calls of sensitivity3() and elasticity3().
    7. Corrected stablestage3() and repvalue3() to properly handle age x stage
       MPMs.
    8. Corrected memory leak issue in aflefko2().


CHANGES IN VERSION 3.3.2 (2021-02-25)
-------------------------------------
  BUG FIXES
    1. Fixed Imports field related to function parasearch().
    2. Fixed loss of fecundity placement in age-by-stage matrices when using
       function supplemental() with function aflefko2().
    3. Fixed default year and patch settings in aflefko2().
    4. Corrected memory allocation issue in historicalize3().


CHANGES IN VERSION 3.3.1 (2021-02-23)
-------------------------------------
  USER-VISIBLE CHANGES
    1. Corrections to vignettes.
    2. Help file typos fixed.


CHANGES IN VERSION 3.3.0 (2021-02-21)
-------------------------------------
  NEW FEATURES
    1. Function supplemental() created to allow greater flexibility in the input
       of reproductive multipliers. All matrix creation functions can now handle
       its output.
    2. Stochastic sensitivity and elasticity analyses now enabled through
       functions sensitivity3() and elasticity3(), respectively.
    3. Functions sensitivity3() and elasticity3() now handle simple lists of A
       matrices, in addition to lefkoMat objects and simple matrices.
    4. Function parasearch() created to allow parallelized model building and
       selection.
  
  USER-VISIBLE CHANGES
    1. Censoring options in verticalize3() and historicalize3() can now handle
       both static and temporally-variable censor variables.
    2. Overwrite and supplemental tables can now include "prop", "immat", and
       "mat" as shorthand for suites of all propagule, immature, and mature
       stages.
    3. Function modelsearch() now gives warning if a dataset is used with NAs in
       individual ID when a mixed modeling approach is requested. It now also
       provides standard diagnostic messages at each step.
    4. Corrections and additions to help files.
  
  BUG FIXES
    1. Fixed censoring protocols in verticalize3(), historicalize3() rlefko3(),
       and rlefko2().
    2. Corrected distribtution algorithm for zero inflation and text output in
       sf_distrib().
    3. Eliminated bug causing high overdispersion parameters from negative
       binomial-based size models to yield function-based matrices with NA
       values for all transitions to stages with positive size.
    4. Fixed issue in which mixed models with a non-zero-inflated negative
       binomial distribution fails to estimate function-based martrices.
    5. Fixed compatibility issues in matrix creation functions with R 3.6.3.
    6. Fixed minor issue in summary.lefkoMat output text.


CHANGES IN VERSION 3.2.0 (2021-01-03)
-------------------------------------
  NEW FEATURES
    1. Function cond_hmpm() added to create conditional hMPMs.
    2. Function slambda3() added to estimate the log stochastic growth rate.
    3. Function summary.lefkoElas() added to summarize elasticities by kind of
       transition.
    4. Added citation() data for package.
    5. Added NEWS section, using package lme4 NEWS as a template.
    
  USER-VISIBLE CHANGES
    1. Corrected inconsistent stage name variable in stage frame creation and
       manipulation functions.
    2. Updated and reorganized vignettes.
    3. Modified stageframes exported by matrix creation functions now include
       entry status variable.
    4. Objects of class lefkoElas now include the original A, U, and F matrices.
    5. Elasticity and sensitivity outputs for lefkoMat objects now include the
       original A, U, and F matrices used as input.
  
  BUG FIXES
    1. Matrix estimation function now create loy tables treating pop and patch
       as strings by default, eliminating possible conversion errors.
    2. Corrected incorrect overwrite() call in lathyrus example used in function
       flefko3() and all population dynamics analysis functions.


CHANGES IN VERSION 3.1.2 (2020-11-16)
-------------------------------------
  BUG FIXES
    1. Corrected auto-conversion of characters to factors occurring on R 3.6.3,
       which affected the creation and interpretation of the $labels element in
       matrix estimation.


CHANGES IN VERSION 3.1.1 (2020-11-13)
-------------------------------------
  BUG FIXES
    1. Fixed bug in lmean() function resulting from an implicit cast and
       affecting users operating lefko3 on Solaris systems.


CHANGES IN VERSION 3.1.0 (2020-11-08)
-------------------------------------
  NEW FEATURES
    1. Added function sfdistrib() to test whether mean = var and the level of
       zero-inflation in count variable data to be used for size and fecundity.
    2. Added zero-inflated Poisson and negative binomial distributions as
       choices for the underlying distribution of size and fecundity.
    3. Added individual and environmental covariates to function-based
       MPM estimation functions.

  USER-VISIBLE CHANGES
    1. Corrected, updated, and reorganized vignettes.

  BUG FIXES
    1. Corrected parameterization of negative binomial distribution in
        function modelsarch().


CHANGES IN VERSION 3.0.0 (2020-10-22)
-------------------------------------
  NEW FEATURES
    1. Added function aflefko2() function to estimate age x stage MPMs.
    2. Added function sensitivity3() to estimate sensitivity matrices of
       historical and ahistorical MPMs.
    3. Added Function elasticity3() to estimate elasticity matrices of
       historical and ahistorical MPMs.

  USER-VISIBLE CHANGES
    1. Increased consistency of output variable names across functions.
    2. Corrected, updated, and reorganized vignettes.
    3. Eliminated faulty parameterization of matrix geometric mean in lmean()
       function.

  BUG FIXES
    1. Corrected core kernel underlying lmean(), and redeveloped in C++ to yield
       faster results.
    2. Corrected parameterization of negative binomial distribution.
    3. Function summary.lefkoMat() now shows which vital rate models were not
       estimated.


CHANGES IN VERSION 2.4.2 (2020-09-12)
-------------------------------------
  USER-VISIBLE CHANGES
    1. All matrix estimators sped up through lapply()-based calls to C++
       kernels.
    2. Function lmean() now keeps the original names of populations and patches.
    3. Corrected incorrect reference links in vignettes.

  BUG FIXES
    1. Fixed memory leak in kernel behind function historicalize3().
    2. Fixed faulty indexing affecting all matrix estimators under certain
       conditions.
    3. Bugs in Cypripedium candidum vignettes and examples caused by incomplete
       overwrite tables fixed.


CHANGES IN VERSION 2.3.0 (2020-08-18)
-------------------------------------
  USER-VISIBLE CHANGES
    1. Major speed up to flefko2() and flefko3() through the incorporation of
       C++ core kernels.

  BUG FIXES
    1. Bug fixed that could lead to the erroneous incorporation of mature
       stages as immature in flefko3() under certain rare circumstances.
    2. Bug fixed that could fit proxy rates into the wrong elements in all
       matrix construction under certain rare circumstances.
    3. Bug fixed that could, under some circumstances, lead to individuals
       being treated as dead when not observed for a period of more than a year.


CHANGES IN VERSION 2.2.2 (2020-07-28)
-------------------------------------
  USER-VISIBLE CHANGES
    1. Revised vignettes.
    2. Improved default handling of reproductive ratio and fecundity ratio.

  BUG FIXES
    1. Fixed calculation of observed lifespan in functions verticalize3() 
       and historicalize3().


CHANGES IN VERSION 2.2.1 (2020-07-18)
-------------------------------------
  USER-VISIBLE CHANGES
    1. Removed some vignettes to reduce size.
    2. Added greater detail to Metadata in DESCRIPTION file

  BUG FIXES
    1. Added on.exit() to modelsearch() to keep user options through that
       routine. 
    2. Fixed bugs in repvalue3.lefkoMat() and repvalue3.matrix().


CHANGES IN VERSION 2.2.0 (2020-07-08)
-------------------------------------
  USER-VISIBLE CHANGES
    1. All internal function documentation now complete.
    2. Reduced vignette sizes.

  BUG FIXES
    1. Fixed bugs in summary.lefkoMod().


CHANGES IN VERSION 2.1.0 (2020-07-06)
-------------------------------------
  NEW FEATURES
    1. Advanced routines developed for deterministic analysis functions,
       including repvalue3() and stablestage3().

  USER-VISIBLE CHANGES
    1. Cleaned up all help pages.

  BUG FIXES
    1. Scattered bugs eliminated.


CHANGES IN VERSION 2.0.0 (2020-06-27)
-------------------------------------
  NEW FEATURES
    1. Stageframe objects now have their own class, and stageframes now handle
       log-size based bin widths.
    2. Sf_create() also now stops if vector lengths are not equal, and can
       create stageframes for IPMs.
    3. Mean matrix function lmean() created.
    4. Added size in time t to juvenile models.
    5. Fecundity models can now use fecundity in t+1 as a response.
    6. Integrated estimation function into verticalize3() and historicalize3().

  USER-VISIBLE CHANGES
    1. All matrix creation functions have been fully rewritten for speed
       (eliminated extraneous find() calls and long loops).
    2. Vignettes split up across chapter files.

  BUG FIXES
    1. Eliminated problems with class interpretation in modelsearch().


CHANGES IN VERSION 1.0.0 (2020-03-24)
-------------------------------------
  NEW FEATURES
    1. Lathyrus dataset added.
    2. Examples added to all core functions.

  USER-VISIBLE CHANGES
    1. All matrix estimation functions have been rewritten to include core C++
       functions, for speed up and memory efficiency.
    2. Added patch functionality to modelsearch(), flefko3(), and flefko2().

  BUG FIXES
    1. Bugs corrected in probability and rate estimation functions.
